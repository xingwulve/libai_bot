<!-- templates/index.html -->
<script>
// 直接调用 Coze API（不建议在生产环境暴露密钥）
async function sendMessage() {
    const input = document.getElementById('userInput');
    const message = input.value.trim();
    if (!message) return;

    input.value = '';
    appendMessage(message, true);

    try {
        const response = await fetch('https://api.coze.cn/open_api/v2/chat', {
            method: 'POST',
            headers: {
                'Authorization': 'Bearer pat_6g9Xfd0T7oddD5yDazzZkhTu8eqMLvyDGRZS6Neu2iIIjc5THG5FhxUpSJsnrpv7', // 注意：密钥暴露在此处
                'Content-Type': 'application/json',
            },
            body: JSON.stringify({
                bot_id: '7482561611249877028',
                user: 'web_user',
                query: message,
                stream: false
            })
        });

        const data = await response.json();
        appendMessage(data.result || '机器人无响应', false);
    } catch (error) {
        appendMessage(`请求失败：${error.message}`, false);
    }
}
</script>
